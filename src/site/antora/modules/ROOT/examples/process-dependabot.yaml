#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to you under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

name: Dependabot Process PR

on:
  push:
    branches:
      - 'dependabot/**'

permissions: read-all

jobs:

# tag::process-dependabot[]
  process-dependabot:
    # Skip this workflow on commits not pushed by Dependabot
    if: ${{ github.actor == 'dependabot[bot]' }}
    uses: apache/logging-parent/.github/workflows/process-dependabot-reusable.yaml@rel/{project-version}
    permissions:
      # The default GITHUB_TOKEN will be used to enable the "auto-merge" on the PR
      pull-requests: write
    secrets:
      AUTO_MERGE_TOKEN: ${{ github.token }}
      CONTENT_WRITE_TOKEN: ${{ secrets.DEPENDABOT_TOKEN }}
      GPG_PASSPHRASE: ${{ secrets.GPG_PASSPHRASE }}
      GPG_PRIVATE_KEY: ${{ secrets.GPG_PRIVATE_KEY }}
    with:
      user_name: 'Release Manager'
      user_email: manager@example.com
      # Necessary to let the reusable workflow reference itself
      reusable_ref: rel/{project-version}
# end::process-dependabot[]
